<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dil MatkabÄ±</title>
    
    <!-- Ä°kon KÃ¼tÃ¼phanesi -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* === TASARIM: SÄ°YAH & CAM EFEKTÄ° (iOS STÄ°LÄ°) === */
        :root { --bg: #000000; --bar: rgba(28,28,30,0.85); --accent: #0A84FF; --text: #ffffff; --border: rgba(255,255,255,0.15); }
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); color: var(--text); font-family: -apple-system, BlinkMacSystemFont, sans-serif; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }

        /* 1. ÃœST BAR */
        .top-bar {
            height: 50px; background: var(--bar); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-bottom: 0.5px solid var(--border); display: flex; align-items: center;
            padding: 0 15px; justify-content: space-between; z-index: 20;
        }
        .site-info { font-size: 15px; font-weight: 600; opacity: 0.9; letter-spacing: -0.5px; }

        /* 2. WEB ALANI (IFRAME) */
        .web-area { flex: 1; position: relative; background: #121212; }
        iframe { width: 100%; height: 100%; border: none; }
        .progress-bar { position: absolute; top: 0; left: 0; height: 3px; background: var(--accent); width: 0%; transition: 0.2s; z-index: 30; }
        
        /* HATA EKRANI (GÃ¼venlik nedeniyle aÃ§Ä±lmayan siteler iÃ§in) */
        .error-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #121212; display: none; flex-direction: column; 
            align-items: center; justify-content: center; z-index: 10; text-align: center; padding: 20px;
        }
        .error-screen.show { display: flex; }
        .fix-btn {
            background: var(--accent); color: white; padding: 12px 24px; 
            border-radius: 12px; border: none; font-size: 16px; margin-top: 20px; font-weight: 600; cursor: pointer;
        }

        /* 3. ALT BAR (KONTROL) */
        .bottom-bar {
            height: 85px; background: var(--bar); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-top: 0.5px solid var(--border); padding-bottom: 20px;
            display: flex; flex-direction: column; justify-content: center; z-index: 20;
        }
        .input-wrapper {
            background: rgba(118,118,128,0.24); margin: 5px 15px; border-radius: 10px;
            height: 36px; display: flex; align-items: center; padding: 0 10px;
        }
        input { flex: 1; background: none; border: none; color: white; font-size: 16px; text-align: center; }
        .controls { display: flex; justify-content: space-around; margin-top: 8px; }
        .icon-btn { background: none; border: none; color: var(--accent); padding: 5px; cursor: pointer; }
        .icon-btn:active { opacity: 0.5; }

        /* 4. YAN MENÃœ (DÄ°L MATKABI) */
        .sidebar {
            position: fixed; top: 0; left: 0; width: 85%; height: 100%;
            background: #1C1C1E; z-index: 100; transform: translateX(-100%);
            transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            border-right: 1px solid var(--border); display: flex; flex-direction: column;
            box-shadow: 10px 0 30px rgba(0,0,0,0.5);
        }
        .sidebar.open { transform: translateX(0); }
        .sidebar-header { padding: 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .sidebar-content { padding: 20px; flex: 1; overflow-y: auto; }
        
        textarea { 
            width: 100%; height: 150px; background: #2C2C2E; border: none; 
            border-radius: 12px; padding: 15px; color: white; font-size: 16px; 
            margin-bottom: 15px; resize: none; 
        }
        .main-btn { 
            width: 100%; height: 50px; background: var(--accent); color: white; 
            border: none; border-radius: 12px; font-size: 16px; font-weight: 600; 
            display: flex; align-items: center; justify-content: center; gap: 8px; cursor: pointer;
        }

        /* Overlay */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 90; display: none; backdrop-filter: blur(4px); }
        .overlay.active { display: block; }

    </style>
</head>
<body>

    <!-- ÃœST BAR -->
    <div class="top-bar">
        <button class="icon-btn" onclick="toggleMenu()"><i data-lucide="book-open"></i></button>
        <span class="site-info" id="title">GiriÅŸ YapÄ±n</span>
        <button class="icon-btn" onclick="reload()"><i data-lucide="rotate-cw" size="18"></i></button>
    </div>

    <!-- WEB ALANI -->
    <div class="web-area">
        <div class="progress-bar" id="progress"></div>
        
        <!-- EÄŸer site iframe'de aÃ§Ä±lmazsa bu buton Ã§Ä±kacak -->
        <div class="error-screen" id="errorScreen">
            <i data-lucide="shield-alert" size="48" color="#F43F5E"></i>
            <h3 style="color:white; margin:15px 0;">Site AÃ§Ä±lmÄ±yor mu?</h3>
            <p style="color:#888; font-size:14px; max-width:80%;">Bu site gÃ¼venlik nedeniyle Ã¶nizleme modunda Ã§alÄ±ÅŸmayabilir.</p>
            <!-- Median 'All Links: Internal' ayarÄ± ile bu buton yeni pencere aÃ§ar -->
            <button class="fix-btn" onclick="openFull()">Tam Ekran AÃ§ â†—</button>
        </div>

        <iframe id="frame" src="" sandbox="allow-forms allow-scripts allow-same-origin allow-popups allow-presentation"></iframe>
    </div>

    <!-- ALT BAR -->
    <div class="bottom-bar">
        <div class="input-wrapper">
            <i data-lucide="lock" size="12" color="#888"></i>
            <input type="text" id="urlInput" placeholder="google.com veya film ara..." autocomplete="off">
        </div>
        <div class="controls">
            <button class="icon-btn" onclick="historyBack()"><i data-lucide="chevron-left" size="28"></i></button>
            <button class="icon-btn" onclick="historyForward()"><i data-lucide="chevron-right" size="28"></i></button>
            <button class="icon-btn" onclick="toggleMenu()" style="background:rgba(10,132,255,0.2); border-radius:50%; padding:8px;"><i data-lucide="mic"></i></button>
            <button class="icon-btn" onclick="share()"><i data-lucide="share"></i></button>
            <button class="icon-btn" onclick="goHome()"><i data-lucide="grid"></i></button>
        </div>
    </div>

    <!-- YAN MENÃœ (DÄ°L MATKABI) -->
    <div class="overlay" onclick="toggleMenu()"></div>
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <span style="font-weight:700; font-size:18px; color:white;">Dil MatkabÄ± ðŸ§ </span>
            <button class="icon-btn" onclick="toggleMenu()"><i data-lucide="x"></i></button>
        </div>
        <div class="sidebar-content">
            <textarea id="drillText" placeholder="Filmden duyduÄŸun cÃ¼mleyi buraya yapÄ±ÅŸtÄ±r..."></textarea>
            
            <button class="main-btn" onclick="speak()">
                <i data-lucide="volume-2"></i> Seslendir
            </button>
            
            <div style="margin-top:20px; border-top:1px solid #333; padding-top:15px; text-align:center;">
                <p style="color:#666; font-size:12px;">Otomatik Dil AlgÄ±lama:<br>JP / RU / AR / DE / ES</p>
                <button class="icon-btn" onclick="clearText()" style="color:#F43F5E; margin-top:10px;">
                    <i data-lucide="trash-2" size="16"></i> Temizle
                </button>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
        const frame = document.getElementById('frame');
        const input = document.getElementById('urlInput');
        const title = document.getElementById('title');
        const errScreen = document.getElementById('errorScreen');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.querySelector('.overlay');
        const progressBar = document.getElementById('progress');

        // --- TARAYICI MOTORU ---
        function go(val) {
            let url = val.trim();
            if(!url) return;
            
            startLoading();
            errScreen.classList.remove('show'); // HatayÄ± gizle

            // 1. YouTube Linki (Otomatik Embed)
            if(url.match(/(youtube\.com|youtu\.be)/)) {
                let v = url.split('v=')[1]?.split('&')[0] || url.split('/').pop();
                url = `https://www.youtube.com/embed/${v}?autoplay=1`;
            } 
            // 2. Google Arama (igu=1 Hilesi)
            else if(!url.includes('.')) {
                url = `https://www.google.com/search?igu=1&q=${encodeURIComponent(url)}`;
            }
            // 3. Normal Site
            else if(!url.startsWith('http')) {
                url = 'https://' + url;
            }

            frame.src = url;
            title.textContent = url.replace('https://','').replace('www.','').split('/')[0];
            input.blur();
        }

        // --- OLAY DÄ°NLEYÄ°CÄ°LERÄ° ---
        input.addEventListener('keypress', (e) => { if(e.key==='Enter') go(input.value); });
        
        // Iframe yÃ¼klenemezse (X-Frame-Options)
        // Not: Bu event her zaman Ã§alÄ±ÅŸmaz, o yÃ¼zden timeout da kullanÄ±yoruz.
        frame.onerror = () => { errScreen.classList.add('show'); finishLoading(); };

        // YÃ¼kleme Animasyonu
        function startLoading() {
            progressBar.style.width = "70%";
            progressBar.style.opacity = "1";
            // 3 saniye iÃ§inde aÃ§Ä±lmazsa hata ekranÄ±nÄ± gÃ¶ster (Backup PlanÄ±)
            setTimeout(() => { 
                if(progressBar.style.opacity === "1") { 
                    // Ä°steÄŸe baÄŸlÄ±: Otomatik hata gÃ¶stermek yerine kullanÄ±cÄ± beklesin
                    // errScreen.classList.add('show'); 
                }
            }, 3000);
        }
        
        frame.onload = () => {
            progressBar.style.width = "100%";
            setTimeout(() => { progressBar.style.opacity="0"; progressBar.style.width="0%"; }, 300);
        };

        // --- NAVÄ°GASYON ---
        function historyBack() { try { frame.contentWindow.history.back(); } catch(e){} }
        function historyForward() { try { frame.contentWindow.history.forward(); } catch(e){} }
        function reload() { frame.src = frame.src; startLoading(); }
        function goHome() { frame.src = ""; input.value = ""; title.textContent="GiriÅŸ YapÄ±n"; errScreen.classList.remove('show'); }
        
        // --- TAM EKRAN AÃ‡ (Median 'Permitted' ayarÄ± ile Ã§alÄ±ÅŸÄ±r) ---
        function openFull() { window.open(frame.src, '_blank'); }

        // --- MENÃœ & SES ---
        function toggleMenu() {
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function speak() {
            let txt = document.getElementById('drillText').value;
            if(!txt) return;
            window.speechSynthesis.cancel();
            let u = new SpeechSynthesisUtterance(txt);
            
            // Dil Tahmini
            if(txt.match(/[\u3000-\u309f]/)) u.lang='ja-JP';
            else if(txt.match(/[\u0400-\u04FF]/)) u.lang='ru-RU';
            else if(txt.match(/[\u0600-\u06FF]/)) u.lang='ar-SA';
            else if(txt.match(/[Â¿Â¡Ã±Ã¡Ã©Ã­Ã³Ãº]/)) u.lang='es-ES'; // Ä°spanyolca ipucu
            else u.lang='de-DE'; // VarsayÄ±lan Almanca

            window.speechSynthesis.speak(u);
        }

        function clearText() { document.getElementById('drillText').value = ""; }
        function share() { navigator.clipboard.writeText(frame.src); alert("Link KopyalandÄ±"); }

    </script>
</body>
</html>
